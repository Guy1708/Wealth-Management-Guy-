
<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wealth Management App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Neutrals -->
    <!-- Application Structure Plan: A single-page dashboard layout with distinct sections for portfolio overview, investment philosophy, risk management, and risk-return analysis. The primary view features an interactive doughnut chart next to a dynamic detail panel. Clicking a chart slice updates the panel with the corresponding asset's strategic role, advantages, and now, currency exposure. A bubble chart visualizes risk vs. return. Navigation is handled via smooth-scrolling top links. A new overall currency exposure chart is added at the bottom. This structure allows judges to explore quantitative allocation and qualitative rationale, analyze strategic positioning based on risk and return, and understand currency diversification. -->
    <!-- Visualization & Content Choices:
        Portfolio Allocation (Data from Report): Goal: Inform/Compare. Viz: Interactive Doughnut Chart (Chart.js/Canvas). Interaction: Click to update detail panel. Justification: Best visual for part-to-whole data, interactivity encourages exploration.
        Asset Details (Qualitative Insights & Currency Exposure): Goal: Explain/Detail. Viz: Dynamically updated HTML content card (Vanilla JS) and a nested Doughnut Chart for currency exposure. Interaction: Content and nested chart update on main chart click. Justification: Presents details on demand, reducing cognitive load, and provides granular currency insights.
        Investment Philosophy (Textual Content): Goal: Inform/Context. Viz: Styled static HTML sections (HTML/Tailwind). Interaction: Smooth scroll navigation. Justification: Foundational information presented clearly.
        Risk Management (Analysis & Structure): Goal: Inform/Context. Viz: Styled static HTML sections (HTML/Tailwind). Interaction: Smooth scroll navigation. Justification: Foundational information presented clearly.
        Risk-Return Analysis (Quantitative Data): Goal: Compare/Organize/Analyze. Viz: Interactive Bubble Chart (Chart.js/Canvas). Interaction: Hover for detailed tooltip. Justification: Effectively visualizes three dimensions (risk, return, percentage) for strategic analysis, providing a clear overview of asset positioning.
        Total Expected Portfolio Return: Goal: Inform/Summarize. Viz: Key metric display (HTML/JS). Interaction: Static display. Justification: Provides an immediate high-level summary of portfolio performance expectation.
        Overall Currency Exposure (New Feature): Goal: Summarize total currency diversification. Viz: Doughnut Chart (Chart.js/Canvas). Interaction: Static display. Justification: Provides a high-level summary of currency diversification across the entire portfolio.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Assistant', sans-serif;
        }
        html {
            scroll-behavior: smooth;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Increased max-width for bubble chart */
            margin-left: auto;
            margin-right: auto;
            height: 400px; /* Base height, adjust with media queries or use Tailwind for responsive heights */
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 450px; /* Adjust height for larger screens */
            }
        }
        /* Custom styles for table view */
        .portfolio-table-container {
            max-height: 400px; /* Limit height for scrollability */
            overflow-y: auto; /* Enable vertical scrolling */
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-lg */
            border: 1px solid #e5e7eb; /* border border-gray-200 */
        }
        .portfolio-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem; /* text-sm */
        }
        .portfolio-table th, .portfolio-table td {
            padding: 0.75rem 1rem; /* p-3 px-4 */
            text-align: right; /* text-right */
            border-bottom: 1px solid #e5e7eb; /* border-b border-gray-200 */
        }
        .portfolio-table th {
            background-color: #f9fafb; /* bg-gray-50 */
            font-weight: 600; /* font-semibold */
            color: #4b5563; /* text-gray-700 */
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .portfolio-table tbody tr:last-child td {
            border-bottom: none;
        }
        .portfolio-table tbody tr:hover {
            background-color: #f3f4f6; /* hover:bg-gray-100 */
        }
    </style>
</head>
<body class="bg-stone-50 text-gray-800">

    <header class="bg-white/80 backdrop-blur-sm sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-center h-16">
                <div class="flex flex-col items-center">
                    <!-- Removed the image tag for the logo -->
                    <h1 class="text-xl font-bold text-teal-700">Wealth Management App</h1>
                    <p class="text-sm text-gray-500 opacity-75 mt-1">×©×œ×•× ×©×™×¨×™</p>
                </div>
                <!-- Removed quick navigation links -->
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        <!-- Removed the "×©×œ×•× ×©×™×¨×™" div from here as it's now in the header -->

        <section id="dashboard" class="mb-16">
            <div class="text-center mb-10">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900">×¡×§×™×¨×” ×›×œ×œ×™×ª ×©×œ ×”×ª×™×§</h2>
                <p class="mt-3 max-w-2xl mx-auto text-lg text-gray-500">
                    ×–×”×• ×“×©×‘×•×¨×“ ××™× ×˜×¨××§×˜×™×‘×™ ×”××¦×™×’ ××ª ×”×§×¦××ª ×”× ×›×¡×™× ×‘×ª×™×§, ×”××‘×•×¡×¡×ª ×¢×œ ××—×•×–×™×. ×œ×—×¦×• ×¢×œ ×›×œ ×—×œ×§ ×‘×ª×¨×©×™× ×›×“×™ ×œ×’×œ×•×ª ××ª ×”×¨×¦×™×•× ×œ ×”××¡×˜×¨×˜×’×™ ×××—×•×¨×™ ×›×œ ×¨×›×™×‘.
                </p>
                <div class="mt-6 p-4 bg-teal-50 rounded-lg shadow-inner inline-block">
                    <p class="text-xl font-semibold text-teal-800">
                        ×ª×©×•××” ×¦×¤×•×™×” ×›×•×œ×œ×ª ××”×ª×™×§: <span id="totalExpectedReturn" class="font-bold"></span>
                    </p>
                </div>
                <div class="mt-6">
                    <button id="toggleViewBtn" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                        ×”×—×œ×£ ×ª×¦×•×’×” (×ª×¨×©×™× / ×˜×‘×œ×”)
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 lg:gap-12 items-center">
                <div class="lg:col-span-2">
                    <div id="chart-view" class="chart-container h-80 md:h-96">
                        <canvas id="portfolioChart"></canvas>
                    </div>
                    <div id="table-view" class="portfolio-table-container hidden">
                        <table class="portfolio-table">
                            <thead>
                                <tr>
                                    <th>× ×›×¡</th>
                                    <th>××—×•×– ××”×ª×™×§</th>
                                    <th>×©×•×•×™ ××•×—×œ×˜ (×©"×—)</th>
                                    <th>×ª×©×•××” ×¦×¤×•×™×” (%)</th>
                                    <th>×¨××ª ×¡×™×›×•×Ÿ</th>
                                </tr>
                            </thead>
                            <tbody id="portfolioTableBody">
                                <!-- Table rows will be inserted here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="lg:col-span-3">
                    <div id="details-card" class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 min-h-[300px] transition-all duration-300">
                        <div id="details-placeholder" class="text-center flex flex-col justify-center items-center h-full">
                             <svg class="w-12 h-12 text-teal-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18m-7 4l4 4m0 0l4-4m-4 4v-8"></path></svg>
                            <h3 class="text-xl font-semibold text-gray-700">×‘×—×¨×• ×¨×›×™×‘ ××”×ª×¨×©×™×</h3>
                            <p class="text-gray-500 mt-2">×œ×—×¦×• ×¢×œ ×¤×œ×— ×‘×ª×¨×©×™× ×”×¢×•×’×” ×›×“×™ ×œ×¨××•×ª ×¤×™×¨×•×˜ ×¢×œ ×ª×¤×§×™×“×• ×•×™×ª×¨×•× ×•×ª×™×• ×‘×ª×™×§.</p>
                        </div>
                        <div id="details-content" class="hidden">
                            <h3 id="details-title" class="text-2xl font-bold text-teal-700 mb-4"></h3>
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-gray-800 text-lg">×ª×¤×§×™×“ ×‘×ª×™×§:</h4>
                                    <p id="details-role" class="text-gray-600"></p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 text-lg">×™×ª×¨×•×Ÿ ××¨×›×–×™:</h4>
                                    <p id="details-advantage" class="text-gray-600"></p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 text-lg">×ª×©×•××” ×©× ×ª×™×ª ×¦×¤×•×™×”:</h4>
                                    <p id="details-expected-return" class="text-gray-600"></p>
                                </div>
                                <div id="currency-chart-container" class="mt-6 hidden">
                                    <h4 class="font-semibold text-gray-800 text-lg mb-2">×—×©×™×¤×” ×œ××˜×‘×¢×•×ª:</h4>
                                    <canvas id="currencyChart" class="max-h-64"></canvas>
                                    <p id="no-currency-data-message" class="text-gray-500 text-sm mt-2 hidden">××™×Ÿ × ×ª×•× ×™ ×—×©×™×¤×” ×œ××˜×‘×¢×•×ª ×–××™× ×™× ×¢×‘×•×¨ ×¤×œ×— ×–×”.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <hr class="my-16 border-gray-200">

        <section id="philosophy" class="mb-16 scroll-mt-20">
             <div class="text-center mb-10">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900">×¤×™×œ×•×¡×•×¤×™×™×ª ×”×”×©×§×¢×” ×©×œ× ×•</h2>
                <p class="mt-3 max-w-2xl mx-auto text-lg text-gray-500">
                    ××¡×˜×¨×˜×’×™×™×ª ×”×”×©×§×¢×” ×©×œ× ×• ××•×©×ª×ª×ª ×¢×œ ×©×œ×•×©×” ×¢×§×¨×•× ×•×ª ×™×¡×•×“, ×”×× ×—×™× ×›×œ ×”×—×œ×˜×” ×•××‘×˜×™×—×™× ×‘× ×™×™×ª ×ª×™×§ ×¢××™×“ ×•×××•×–×Ÿ ×”××•×ª×× ×œ××˜×¨×•×ª ××¨×•×›×•×ª ×˜×•×•×—.
                </p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100 text-center">
                    <div class="text-teal-600 mb-4">
                        <span class="text-4xl">ğŸŒ</span>
                    </div>
                    <h3 class="text-xl font-bold mb-2">×’×™×•×•×Ÿ</h3>
                    <p class="text-gray-600">×¤×™×–×•×¨ ×¨×—×‘ ×©×œ ×”×©×§×¢×•×ª ×¢×œ ×¤× ×™ ×¡×•×’×™ × ×›×¡×™× ×©×•× ×™× ×›×“×™ ×œ××–×¢×¨ ×¡×™×›×•× ×™×.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100 text-center">
                    <div class="text-teal-600 mb-4">
                        <span class="text-4xl">â³</span>
                    </div>
                    <h3 class="text-xl font-bold mb-2">××•×¤×§ ××¨×•×š ×˜×•×•×—</h3>
                    <p class="text-gray-600">×”×ª××§×“×•×ª ×‘×¦××™×—×” ×™×¦×™×‘×” ×•×‘×ª×©×•××•×ª ××ª××©×›×•×ª ×œ××•×¨×š ×–××Ÿ.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100 text-center">
                    <div class="text-teal-600 mb-4">
                         <span class="text-4xl">âš–ï¸</span>
                    </div>
                    <h3 class="text-xl font-bold mb-2">××™×–×•×Ÿ ×¡×™×›×•×Ÿ-×ª×©×•××”</h3>
                    <p class="text-gray-600">×©×™×œ×•×‘ × ×›×¡×™× ×‘×¢ ×‘×¢×œ×™ ×¤×¨×•×¤×™×œ×™ ×¡×™×›×•×Ÿ ×©×•× ×™× ×œ×™×¦×™×¨×ª ×ª×™×§ ×¢××™×“.</p>
                </div>
            </div>
        </section>

        <hr class="my-16 border-gray-200">

        <!-- Removed the entire section for "××¡×˜×¨×˜×’×™×™×ª × ×™×”×•×œ ×”×¡×™×›×•× ×™×" -->

        <section id="risk-return-analysis" class="scroll-mt-20">
            <div class="text-center mb-10">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900">× ×™×ª×•×— ×¡×™×›×•×Ÿ-×ª×©×•××”</h2>
                <p class="mt-3 max-w-2xl mx-auto text-lg text-gray-500">
                    ×’×¨×£ ×–×” ××¦×™×’ ××ª ×”×§×¦××•×ª ×”×ª×™×§ ×‘×™×—×¡ ×œ×¨××ª ×”×¡×™×›×•×Ÿ ×•×¦×¤×™ ×”×ª×©×•××” ×”×©× ×ª×™×ª ×©×œ ×›×œ ×§×˜×’×•×¨×™×”. ×’×•×“×œ ×”×‘×•×¢×” ××™×™×¦×’ ××ª ××—×•×– ×”×”×©×§×¢×” ×”×›×•×œ×œ ×©×œ×” ×‘×ª×™×§.
                </p>
            </div>
            <div class="max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-lg border border-gray-200">
                <div class="chart-container h-[400px] md:h-[450px]">
                    <canvas id="bubbleChart"></canvas>
                </div>
            </div>
        </section>

        <hr class="my-16 border-gray-200">

        <section id="overall-currency-exposure" class="scroll-mt-20">
            <div class="text-center mb-10">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900">×—×©×™×¤×ª ×”×ª×™×§ ×”×›×•×œ×œ×ª ×œ××˜×‘×¢×•×ª</h2>
                <p class="mt-3 max-w-2xl mx-auto text-lg text-gray-500">
                    ×’×¨×£ ×–×” ××¦×™×’ ××ª ×”×—×©×™×¤×” ×”×›×•×œ×œ×ª ×©×œ ×ª×™×§ ×”×”×©×§×¢×•×ª ×œ××˜×‘×¢×•×ª ×”×©×•× ×™×, ×•××“×’×™×© ××ª ×¤×™×–×•×¨ ×”×¡×™×›×•× ×™× ×”××˜×‘×¢×™.
                </p>
            </div>
            <div class="max-w-xl mx-auto bg-white p-8 rounded-xl shadow-lg border border-gray-200">
                <div class="chart-container h-80 md:h-96">
                    <canvas id="overallCurrencyChart"></canvas>
                </div>
            </div>
        </section>

    </main>
    
    <footer class="bg-gray-800 text-white mt-16">
        <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center">
            <p>&copy; 2025 Wealth Management App. ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª.</p>
        </div>
    </footer>


    <script>
        const totalPortfolioValue = 90000000; // 90 million ILS

        const currencyColors = {
            '×©×§×œ': { color: '#4CAF50', symbol: 'â‚ª' }, // Green
            '×“×•×œ×¨': { color: '#2196F3', symbol: '$' }, // Blue
            '××™×¨×•': { color: '#FFC107', symbol: 'â‚¬' }, // Amber
            '××—×¨': { color: '#9E9E9E', symbol: '' } // Gray
        };

        const portfolioData = [
            {
                label: '×‘×™×˜×§×•×™×Ÿ',
                value: 4, // Changed from 7 to 4
                role: '××¨×›×™×‘ ×¦××™×—×” ××’×¨×¡×™×‘×™, ×—×©×™×¤×” ×œ× ×›×¡ ×“×™×’×™×˜×œ×™ ×‘×¢×œ ×¤×•×˜× ×¦×™××œ ×ª×©×•××” ×’×‘×•×”.',
                advantage: '×¤×•×˜× ×¦×™××œ ×¨×•×•×—×™× ××©××¢×•×ª×™×™× ×‘×ª××•×¨×” ×œ×¡×™×›×•×Ÿ ×’×‘×•×”.',
                color: '#F7931A', // Bitcoin orange
                risk: 5, // Very High
                expectedReturn: 30, // Updated
                currencyExposure: [{ currency: '×“×•×œ×¨', percentage: 100, color: currencyColors['×“×•×œ×¨'].color }]
            },
            {
                label: '×§×¨×Ÿ ×—×•×‘',
                value: 21, // Changed from 20 to 21
                role: '××¡×¤×§×ª ×™×¦×™×‘×•×ª ×•×”×›× ×¡×” ×©×•×˜×¤×ª, ×•××”×•×•×ª ××¨×›×™×‘ ×”×’× ×ª×™ ×‘×ª×™×§.',
                advantage: '××¤×—×™×ª×” ×ª× ×•×“×ª×™×•×ª ×›×•×œ×œ×ª ×•××¡×¤×§×ª ×‘×¡×™×¡ ×™×¦×™×‘.',
                color: '#0D9488', // Teal-600
                risk: 2.5, // Swapped with ×§×¨× ×•×ª ×ª×©×ª×™×ª
                expectedReturn: 7, // Updated
                currencyExposure: [
                    { currency: '×©×§×œ', percentage: 55, color: currencyColors['×©×§×œ'].color },
                    { currency: '××™×¨×•', percentage: 20, color: currencyColors['××™×¨×•'].color },
                    { currency: '×“×•×œ×¨', percentage: 20, color: currencyColors['×“×•×œ×¨'].color },
                    { currency: '××—×¨', percentage: 5, color: currencyColors['××—×¨'].color }
                ]
            },
            {
                label: '××–×•××Ÿ',
                value: 1, // Calculated as remaining 1%
                role: '×©×•××¨ ×¢×œ × ×–×™×œ×•×ª ×œ×¦×¨×›×™× ×‘×œ×ª×™ ×¦×¤×•×™×™× ××• ×œ× ×™×¦×•×œ ×”×–×“×× ×•×™×•×ª ×˜×§×˜×™×•×ª.',
                advantage: '×’××™×©×•×ª ×ª×¤×¢×•×œ×™×ª ×•×‘×™×˜×—×•×Ÿ ×¤×™× × ×¡×™, ×œ×œ× ×¡×™×›×•×Ÿ ×ª× ×•×“×ª×™×•×ª ×©×•×§.',
                color: '#9CA3AF', // Gray-400
                risk: 0, // Changed to 0
                expectedReturn: 0, // Changed to 0
                currencyExposure: [{ currency: '×©×§×œ', percentage: 100, color: currencyColors['×©×§×œ'].color }]
            },
            {
                label: '×§×¨×Ÿ ×”×•×Ÿ ×¡×™×›×•×Ÿ',
                value: 10, // 10%
                role: '×× ×•×¢ ×”×¦××™×—×” ×©×œ ×”×ª×™×§, ××›×•×•×Ÿ ×œ×—×‘×¨×•×ª ×‘×¢×œ×•×ª ×¤×•×˜× ×¦×™××œ ×’×‘×•×” ×‘×©×œ×‘×™× ××•×§×“××™×.',
                advantage: '×¤×•×˜× ×¦×™××œ ×œ×ª×©×•××•×ª ××©××¢×•×ª×™×•×ª ×•××§×¡×¤×•× × ×¦×™××œ×™×•×ª.',
                color: '#F97316', // Orange-500
                risk: 5, // Very High
                expectedReturn: 20, // Updated
                currencyExposure: [
                    { currency: '×©×§×œ', percentage: 40, color: currencyColors['×©×§×œ'].color },
                    { currency: '×“×•×œ×¨', percentage: 50, color: currencyColors['×“×•×œ×¨'].color },
                    { currency: '××™×¨×•', percentage: 10, color: currencyColors['××™×¨×•'].color }
                ]
            },
            {
                label: '×§×¨× ×•×ª ×ª×©×ª×™×ª',
                value: 22, // Changed from 23 to 22
                role: '××¦×™×¢×•×ª ×ª×©×•××•×ª ×™×¦×™×‘×•×ª ×•××¨×•×›×•×ª ×˜×•×•×—, ×œ×¨×•×‘ ×§×©×•×¨×•×ª ×œ×©×™×¨×•×ª×™× ×—×™×•× ×™×™×.',
                advantage: '×”×’× ×” ××¤× ×™ ××™× ×¤×œ×¦×™×” ×•×¤×•×˜× ×¡×™××œ ×¦××™×—×” ×™×¦×™×‘.',
                color: '#2DD4BF', // Teal-400
                risk: 2, // Swapped with ×§×¨×Ÿ ×—×•×‘
                expectedReturn: 7, // Updated
                currencyExposure: [
                    { currency: '×“×•×œ×¨', percentage: 30, color: currencyColors['×“×•×œ×¨'].color },
                    { currency: '××™×¨×•', percentage: 20, color: currencyColors['××™×¨×•'].color },
                    { currency: '×©×§×œ', percentage: 40, color: currencyColors['×©×§×œ'].color },
                    { currency: '××—×¨', percentage: 10, color: currencyColors['××—×¨'].color }
                ]
            },
            {
                label: '××’×—',
                value: 15, // Changed from 10 to 15
                role: '× ×›×¡ ×—×•×‘ ×”××¦×™×¢ ×™×¦×™×‘×•×ª ×™×—×¡×™×ª ×•×”×›× ×¡×” ×§×‘×•×¢×”, ×•××©××© ×›×¨×›×™×‘ ××’×Ÿ ×‘×ª×™×§.',
                advantage: '××’×•×•×Ÿ ××ª ×ª×™×§ ×”×—×•×‘ ×•××¡×¤×§ ××§×•×¨ ×”×›× ×¡×” × ×•×¡×£ ×¢× ×¡×™×›×•×Ÿ × ××•×š ×™×—×¡×™×ª.',
                color: '#60A5FA', // Blue-400
                risk: 1, // Changed to 1
                expectedReturn: 4, // Updated
                currencyExposure: [
                    { currency: '×©×§×œ', percentage: 50, color: currencyColors['×©×§×œ'].color },
                    { currency: '×“×•×œ×¨', percentage: 25, color: currencyColors['×“×•×œ×¨'].color },
                    { currency: '××™×¨×•', percentage: 25, color: currencyColors['××™×¨×•'].color }
                ]
            },
            {
                label: '×¡×—×™×¨',
                value: 25, // 25%
                role: '×”×—×œ×§ ×”× ×–×™×œ ×‘×ª×™×§ ×™×©××© ×›××¨×›×™×‘ ×¢× ×¤×•×˜× ×¦×™××œ ×ª×©×•××” ×’×‘×•×”×”, ×•×’× ×œ×”×©×œ××ª ×”×ª×–×¨×™× ×•×œ×”×—×–×¨ ×”×”×œ×•×•××”.', // Updated role
                advantage: '××¦×™×¢×•×ª ×’××™×©×•×ª ×•× ×’×™×©×•×ª ××™×™×“×™×ª ×œ× ×™×¦×•×œ ×”×–×“×× ×•×™×•×ª ×‘×©×•×§ ×”×¦×™×‘×•×¨×™ ×•×œ× ×–×™×œ×•×ª ×”×›×¡×£ ×œ××§×¨×” ×”×¦×•×¨×š.', // Updated advantage
                color: '#14B8A6', // Teal-500
                risk: 4, // Medium-High
                expectedReturn: 10, // Updated
                currencyExposure: [
                    { currency: '×©×§×œ', percentage: 55, color: currencyColors['×©×§×œ'].color },
                    { currency: '×“×•×œ×¨', percentage: 35, color: currencyColors['×“×•×œ×¨'].color },
                    { currency: '××™×¨×•', percentage: 10, color: currencyColors['××™×¨×•'].color }
                ]
            },
            {
                label: '×§×¨×Ÿ ×¤×™×œ× ×ª×¨×•×¤×™×ª',
                value: 2, // 2%
                role: '××•×§×“×©×•×ª ×œ× ×ª×™× ×” ×¤×™×œ× ×ª×¨×•×¤×™×ª, ×•××©×§×¤×•×ª ××ª ××—×•×™×‘×•×ª× ×• ×œ××—×¨×™×•×ª ×—×‘×¨×ª×™×ª.',
                advantage: '×ª×¨×•××” ×œ×§×”×™×œ×” ×•×—×™×–×•×§ ×¢×¨×›×™ ×”××¨×’×•×Ÿ, ×¢× ×ª×©×•××” ×¦× ×•×¢×”.',
                color: '#A78BFA', // Violet-400
                risk: 0, // Changed to 0
                expectedReturn: 0, // Changed to 0
                currencyExposure: [{ currency: '×©×§×œ', percentage: 100, color: currencyColors['×©×§×œ'].color }]
            }
        ];

        // Ensure total percentage sums to 100 and calculate absolute values
        let currentTotalPercentage = 0;
        portfolioData.forEach(item => {
            currentTotalPercentage += item.value;
            item.absoluteValue = (item.value / 100) * totalPortfolioValue; // Calculate absolute value for each item
        });

        if (currentTotalPercentage !== 100) {
            console.warn(`Total percentage is ${currentTotalPercentage}%, not 100%. Adjusting "××–×•××Ÿ" to compensate.`);
            const cashIndex = portfolioData.findIndex(item => item.label === '××–×•××Ÿ');
            if (cashIndex !== -1) {
                portfolioData[cashIndex].value += (100 - currentTotalPercentage);
                portfolioData[cashIndex].absoluteValue = (portfolioData[cashIndex].value / 100) * totalPortfolioValue;
            } else {
                console.error("Cannot balance portfolio to 100% as '××–×•××Ÿ' is not found and total is not 100.");
            }
        }

        // Calculate Total Expected Return for the portfolio (for the top display)
        let weightedExpectedReturnOverall = 0;
        portfolioData.forEach(item => {
            weightedExpectedReturnOverall += (item.value / 100) * item.expectedReturn;
        });
        document.getElementById('totalExpectedReturn').textContent = `${weightedExpectedReturnOverall.toFixed(1)}%`;


        // Doughnut Chart
        const ctxDoughnut = document.getElementById('portfolioChart').getContext('2d');
        const portfolioChart = new Chart(ctxDoughnut, {
            type: 'doughnut',
            data: {
                labels: portfolioData.map(item => item.label),
                datasets: [{
                    label: '×”×§×¦××ª ×ª×™×§',
                    data: portfolioData.map(item => item.value), // Use value directly as percentage
                    backgroundColor: portfolioData.map(item => item.color),
                    borderColor: '#ffffff',
                    borderWidth: 3,
                    hoverOffset: 16
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '60%',
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            font: {
                                family: 'Assistant',
                                size: 14
                            },
                            padding: 20
                        }
                    },
                    tooltip: {
                        bodyFont: {
                            family: 'Assistant'
                        },
                        titleFont: {
                             family: 'Assistant'
                        },
                        callbacks: {
                            label: function(context) {
                                const dataIndex = context.dataIndex;
                                const item = portfolioData[dataIndex];
                                return [
                                    `${context.label}:`,
                                    `×¡×›×•×: ${item.absoluteValue.toLocaleString('he-IL', { style: 'currency', currency: 'ILS', minimumFractionDigits: 0, maximumFractionDigits: 0 })}`,
                                    `××—×•×– ××”×ª×™×§: ${item.value}%`,
                                    `×ª×©×•××” ×¦×¤×•×™×”: ${item.expectedReturn}%`
                                ];
                            }
                        }
                    }
                },
                animation: {
                    animateScale: true,
                    animateRotate: true
                }
            }
        });

        const detailsPlaceholder = document.getElementById('details-placeholder');
        const detailsContent = document.getElementById('details-content');
        const detailsTitle = document.getElementById('details-title');
        const detailsRole = document.getElementById('details-role');
        const detailsAdvantage = document.getElementById('details-advantage');
        const detailsExpectedReturn = document.getElementById('details-expected-return');
        const currencyChartContainer = document.getElementById('currency-chart-container');
        const noCurrencyDataMessage = document.getElementById('no-currency-data-message');

        let currencyChartInstance = null; // To store the Chart.js instance for currency data

        function updateDetails(index) {
            if (index < 0 || index >= portfolioData.length) {
                detailsPlaceholder.style.display = 'flex';
                detailsContent.style.display = 'none';
                return;
            };

            const item = portfolioData[index];
            detailsTitle.textContent = item.label;
            detailsRole.textContent = item.role;
            detailsAdvantage.textContent = item.advantage;
            detailsExpectedReturn.textContent = `${item.expectedReturn}%`;

            detailsPlaceholder.style.display = 'none';
            detailsContent.style.display = 'block';

            // Update Currency Chart
            if (currencyChartInstance) {
                currencyChartInstance.destroy(); // Destroy previous instance
            }

            if (item.currencyExposure && item.currencyExposure.length > 0) {
                currencyChartContainer.classList.remove('hidden');
                noCurrencyDataMessage.classList.add('hidden');

                const ctxCurrency = document.getElementById('currencyChart').getContext('2d');
                currencyChartInstance = new Chart(ctxCurrency, {
                    type: 'doughnut',
                    data: {
                        labels: item.currencyExposure.map(cur => cur.currency),
                        datasets: [{
                            data: item.currencyExposure.map(cur => cur.percentage),
                            backgroundColor: item.currencyExposure.map(cur => cur.color),
                            borderColor: '#ffffff',
                            borderWidth: 2,
                            hoverOffset: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '50%',
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    font: {
                                        family: 'Assistant',
                                        size: 12
                                    },
                                    padding: 10
                                }
                            },
                            tooltip: {
                                bodyFont: {
                                    family: 'Assistant'
                                },
                                titleFont: {
                                     family: 'Assistant'
                                },
                                callbacks: {
                                    label: function(context) {
                                        const percentage = context.parsed.toFixed(1);
                                        const currencyLabel = context.label;
                                        const currencySymbol = currencyColors[currencyLabel] ? currencyColors[currencyLabel].symbol : '';
                                        return `${currencyLabel} ${currencySymbol}: ${percentage}%`;
                                    }
                                }
                            }
                        }
                    }
                });
            } else {
                currencyChartContainer.classList.add('hidden');
                noCurrencyDataMessage.classList.remove('hidden');
            }
        }

        document.getElementById('portfolioChart').onclick = (evt) => {
            const activePoints = portfolioChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
            if (activePoints.length) {
                const firstPoint = activePoints[0];
                const index = firstPoint.index;
                updateDetails(index);
            }
        };

        // Bubble Chart
        const ctxBubble = document.getElementById('bubbleChart').getContext('2d');

        // Calculate average risk and average expected return for the ENTIRE portfolio
        // This ensures consistency with the total expected return displayed at the top.
        let totalWeightedRiskForAverage = 0;
        let totalWeightedExpectedReturnForAverage = 0;
        let totalPercentageForAverage = 0;

        portfolioData.forEach(item => {
            totalWeightedRiskForAverage += item.risk * item.value; // Weighted average
            totalWeightedExpectedReturnForAverage += item.expectedReturn * item.value; // Weighted average
            totalPercentageForAverage += item.value; // Sum of percentages
        });

        const averageRisk = totalWeightedRiskForAverage / totalPercentageForAverage;
        const averageExpectedReturn = totalWeightedExpectedReturnForAverage / totalPercentageForAverage;

        const bubbleChart = new Chart(ctxBubble, {
            type: 'bubble',
            data: {
                datasets: [{
                    label: '× ×™×ª×•×— ×¡×™×›×•×Ÿ-×ª×©×•××”',
                    // Filter out '×§×¨×Ÿ ×¤×™×œ× ×ª×¨×•×¤×™×ª' and '××–×•××Ÿ' for display purposes only
                    data: portfolioData.filter(item => item.label !== '×§×¨×Ÿ ×¤×™×œ× ×ª×¨×•×¤×™×ª' && item.label !== '××–×•××Ÿ').map(item => ({
                        x: item.risk,
                        y: item.expectedReturn,
                        r: item.value * 0.5, // Use value directly as percentage for radius scaling
                        label: item.label // Store label for tooltip
                    })),
                    backgroundColor: portfolioData.filter(item => item.label !== '×§×¨×Ÿ ×¤×™×œ× ×ª×¨×•×¤×™×ª' && item.label !== '××–×•××Ÿ').map(item => item.color + 'B3'), // Add transparency
                    borderColor: portfolioData.filter(item => item.label !== '×§×¨×Ÿ ×¤×™×œ× ×ª×¨×•×¤×™×ª' && item.label !== '××–×•××Ÿ').map(item => item.color),
                    borderWidth: 2
                },
                {
                    label: '×××•×¦×¢ ×”×ª×™×§', // Label for the average point
                    data: [{
                        x: averageRisk,
                        y: averageExpectedReturn,
                        r: 10, // Fixed radius for the average point to make it stand out
                        label: '×××•×¦×¢ ×”×ª×™×§'
                    }],
                    backgroundColor: '#FF0000', // Red color for the average point
                    borderColor: '#CC0000',
                    borderWidth: 3,
                    pointStyle: 'star' // Star shape for the average point
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        type: 'linear',
                        position: 'bottom',
                        title: {
                            display: true,
                            text: '×¨××ª ×¡×™×›×•×Ÿ (1=× ××•×š ×××•×“, 5=×’×‘×•×” ×××•×“)',
                            font: {
                                family: 'Assistant',
                                size: 16
                            }
                        },
                        ticks: {
                            stepSize: 1,
                            font: {
                                family: 'Assistant'
                            }
                        },
                        min: 0,
                        max: 6
                    },
                    y: {
                        type: 'linear',
                        title: {
                            display: true,
                            text: '×¦×¤×™ ×ª×©×•××” ×©× ×ª×™×ª (%)',
                            font: {
                                family: 'Assistant',
                                size: 16
                            }
                        },
                        ticks: {
                            stepSize: 5, // Adjusted step size for percentage returns
                            font: {
                                family: 'Assistant'
                            }
                        },
                        min: 0,
                        max: 35 // Adjusted max for new returns
                    }
                },
                plugins: {
                    legend: {
                        display: true, // Display legend for bubble chart
                        labels: {
                            font: {
                                family: 'Assistant',
                                size: 14
                            },
                            padding: 20,
                            filter: function(legendItem, chartData) {
                                // Only show the legend for "×××•×¦×¢ ×”×ª×™×§" and hide "× ×™×ª×•×— ×¡×™×›×•×Ÿ-×ª×©×•××”"
                                return legendItem.text === '×××•×¦×¢ ×”×ª×™×§';
                            }
                        }
                    },
                    tooltip: {
                        bodyFont: {
                            family: 'Assistant'
                        },
                        titleFont: {
                             family: 'Assistant'
                        },
                        callbacks: {
                            label: function(context) {
                                const rawData = context.raw;
                                if (rawData.label === '×××•×¦×¢ ×”×ª×™×§') {
                                    return [
                                        `× ×§×•×“×ª ×××•×¦×¢ ×”×ª×™×§:`,
                                        `×¡×™×›×•×Ÿ ×××•×¦×¢: ${rawData.x.toFixed(2)}`,
                                        `×ª×©×•××” ×××•×¦×¢×ª: ${rawData.y.toFixed(2)}%`
                                    ];
                                } else {
                                    // Find the original item from portfolioData using the label stored in context.raw
                                    const item = portfolioData.find(dataItem => dataItem.label === rawData.label);

                                    if (!item) return ''; // Should not happen if data is correctly filtered

                                    return [
                                        `×§×˜×’×•×¨×™×”: ${item.label}`,
                                        `×¡×™×›×•×Ÿ: ${item.risk}`,
                                        `×ª×©×•××” ×¦×¤×•×™×”: ${item.expectedReturn}%`,
                                        `××—×•×– ××”×ª×™×§: ${item.value}%`,
                                        `×¡×›×•×: ${item.absoluteValue.toLocaleString('he-IL', { style: 'currency', currency: 'ILS', minimumFractionDigits: 0, maximumFractionDigits: 0 })}`
                                    ];
                                }
                            }
                        }
                    }
                }
            }
        });

        // Overall Currency Exposure Chart
        const overallCurrencyExposure = {};
        portfolioData.forEach(portfolioItem => {
            if (portfolioItem.currencyExposure) {
                portfolioItem.currencyExposure.forEach(currencyItem => {
                    const weightedPercentage = (portfolioItem.value / 100) * currencyItem.percentage;
                    if (overallCurrencyExposure[currencyItem.currency]) {
                        overallCurrencyExposure[currencyItem.currency] += weightedPercentage;
                    } else {
                        overallCurrencyExposure[currencyItem.currency] = weightedPercentage;
                    }
                });
            }
        });

        const overallCurrencyLabels = Object.keys(overallCurrencyExposure);
        const overallCurrencyData = Object.values(overallCurrencyExposure);
        const overallCurrencyBackgroundColors = overallCurrencyLabels.map(label => currencyColors[label] ? currencyColors[label].color : '#CCCCCC'); // Fallback color

        const ctxOverallCurrency = document.getElementById('overallCurrencyChart').getContext('2d');
        const overallCurrencyChart = new Chart(ctxOverallCurrency, {
            type: 'doughnut',
            data: {
                labels: overallCurrencyLabels,
                datasets: [{
                    data: overallCurrencyData,
                    backgroundColor: overallCurrencyBackgroundColors,
                    borderColor: '#ffffff',
                    borderWidth: 3,
                    hoverOffset: 16
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '60%',
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            font: {
                                family: 'Assistant',
                                size: 14
                            },
                            padding: 20
                        }
                    },
                    tooltip: {
                        bodyFont: {
                            family: 'Assistant'
                        },
                        titleFont: {
                             family: 'Assistant'
                        },
                        callbacks: {
                            label: function(context) {
                                const percentage = context.parsed.toFixed(1);
                                const currencyLabel = context.label;
                                const currencySymbol = currencyColors[currencyLabel] ? currencyColors[currencyLabel].symbol : '';
                                return `${currencyLabel} ${currencySymbol}: ${percentage}%`;
                            }
                        }
                    }
                },
                animation: {
                    animateScale: true,
                    animateRotate: true
                }
            }
        });

        // Function to populate the table
        function populatePortfolioTable() {
            const tableBody = document.getElementById('portfolioTableBody');
            tableBody.innerHTML = ''; // Clear existing rows

            portfolioData.forEach(item => {
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td>${item.label}</td>
                    <td>${item.value}%</td>
                    <td>${item.absoluteValue.toLocaleString('he-IL', { style: 'currency', currency: 'ILS', minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                    <td>${item.expectedReturn}%</td>
                    <td>${item.risk}</td>
                `;
            });
        }

        // Toggle view functionality
        const toggleViewBtn = document.getElementById('toggleViewBtn');
        const chartView = document.getElementById('chart-view');
        const tableView = document.getElementById('table-view');
        let isChartView = true;

        toggleViewBtn.addEventListener('click', () => {
            if (isChartView) {
                chartView.classList.add('hidden');
                tableView.classList.remove('hidden');
                populatePortfolioTable(); // Populate table when switching to table view
                toggleViewBtn.textContent = '×”×—×œ×£ ×ª×¦×•×’×” (×˜×‘×œ×” / ×ª×¨×©×™×)';
            } else {
                tableView.classList.add('hidden');
                chartView.classList.remove('hidden');
                toggleViewBtn.textContent = '×”×—×œ×£ ×ª×¦×•×’×” (×ª×¨×©×™× / ×˜×‘×œ×”)';
            }
            isChartView = !isChartView;
        });

        // Initialize with first item or placeholder
        // updateDetails(0); // Optional: uncomment to show first item by default
    </script>

</body>
</html>